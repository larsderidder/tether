# Dev mode: Codex sidecar only
# Agent and UI run locally on the host. Sidecar auto-reloads on changes.

services:
  codex-sidecar:
    build:
      context: .
      dockerfile: codex-sdk-sidecar/Dockerfile
    network_mode: host
    volumes:
      - ./codex-sdk-sidecar/src:/app/src:ro
    command: ["npx", "tsx", "watch", "src/index.ts"]
    environment:
      - TETHER_CODEX_SIDECAR_HOST=127.0.0.1
      - TETHER_CODEX_SIDECAR_PORT=8788
      - TETHER_CODEX_SIDECAR_TOKEN=${TETHER_CODEX_SIDECAR_TOKEN:-}
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - TETHER_CODEX_SIDECAR_MODEL=${TETHER_CODEX_SIDECAR_MODEL:-}
